{"ast":null,"code":"import { invariant, isNumericalString } from 'motion-utils';\nimport { isCSSVariableToken } from './is-css-variable.mjs';\n/**\n * Parse Framer's special CSS variable format into a CSS token and a fallback.\n *\n * ```\n * `var(--foo, #fff)` => [`--foo`, '#fff']\n * ```\n *\n * @param current\n */\n\nconst splitCSSVariableRegex = // eslint-disable-next-line redos-detector/no-unsafe-regex -- false positive, as it can match a lot of words\n/^var\\(--(?:([\\w-]+)|([\\w-]+), ?([a-zA-Z\\d ()%#.,-]+))\\)/u;\n\nfunction parseCSSVariable(current) {\n  const match = splitCSSVariableRegex.exec(current);\n  if (!match) return [,];\n  const [, token1, token2, fallback] = match;\n  return [`--${token1 ?? token2}`, fallback];\n}\n\nconst maxDepth = 4;\n\nfunction getVariableValue(current, element) {\n  let depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  invariant(depth <= maxDepth, `Max CSS variable fallback depth detected in property \"${current}\". This may indicate a circular fallback dependency.`, \"max-css-var-depth\");\n  const [token, fallback] = parseCSSVariable(current); // No CSS variable detected\n\n  if (!token) return; // Attempt to read this CSS variable off the element\n\n  const resolved = window.getComputedStyle(element).getPropertyValue(token);\n\n  if (resolved) {\n    const trimmed = resolved.trim();\n    return isNumericalString(trimmed) ? parseFloat(trimmed) : trimmed;\n  }\n\n  return isCSSVariableToken(fallback) ? getVariableValue(fallback, element, depth + 1) : fallback;\n}\n\nexport { getVariableValue, parseCSSVariable };","map":{"version":3,"mappings":";;AAIA;;;;;;;;AAQG;;AAEH,MAAMA,qBAAqB,GACvB;AACA,0DAFJ;;AAGM,SAAUC,gBAAV,CAA2BC,OAA3B,EAA0C;EAC5C,MAAMC,KAAK,GAAGH,qBAAqB,CAACI,IAAtB,CAA2BF,OAA3B,CAAd;EACA,IAAI,CAACC,KAAL,EAAY,OAAO,GAAP;EAEZ,MAAM,GAAGE,MAAH,EAAWC,MAAX,EAAmBC,QAAnB,IAA+BJ,KAArC;EACA,OAAO,CAAC,KAAKE,MAAM,IAAIC,MAAQ,EAAxB,EAA0BC,QAA1B,CAAP;AACH;;AAED,MAAMC,QAAQ,GAAG,CAAjB;;AACM,SAAUC,gBAAV,CACFP,OADE,EAEFQ,OAFE,EAGO;EAAA,IAATC,KAAS,uEAAD,CAAC;EAETC,SAAS,CACLD,KAAK,IAAIH,QADJ,EAEoD,gEAA6D,sDAFjH,EAGL,mBAHK,CAAT;EAMA,MAAM,CAACK,KAAD,EAAQN,QAAR,IAAoBN,gBAAgB,CAACC,OAAD,CAA1C,CARS;;EAWT,IAAI,CAACW,KAAL,EAAY,OAXH;;EAcT,MAAMC,QAAQ,GAAGC,MAAM,CAACC,gBAAP,CAAwBN,OAAxB,EAAiCO,gBAAjC,CAAkDJ,KAAlD,CAAjB;;EAEA,IAAIC,QAAJ,EAAc;IACV,MAAMI,OAAO,GAAGJ,QAAQ,CAACK,IAAT,EAAhB;IACA,OAAOC,iBAAiB,CAACF,OAAD,CAAjB,GAA6BG,UAAU,CAACH,OAAD,CAAvC,GAAmDA,OAA1D;EACH;;EAED,OAAOI,kBAAkB,CAACf,QAAD,CAAlB,GACDE,gBAAgB,CAACF,QAAD,EAAWG,OAAX,EAAoBC,KAAK,GAAG,CAA5B,CADf,GAEDJ,QAFN;AAGJ","names":["splitCSSVariableRegex","parseCSSVariable","current","match","exec","token1","token2","fallback","maxDepth","getVariableValue","element","depth","invariant","token","resolved","window","getComputedStyle","getPropertyValue","trimmed","trim","isNumericalString","parseFloat","isCSSVariableToken"],"sources":["C:\\Projects\\TVMazee\\node_modules\\motion-dom\\src\\animation\\utils\\css-variables-conversion.ts"],"sourcesContent":["import { invariant, isNumericalString } from \"motion-utils\"\nimport { AnyResolvedKeyframe } from \"../types\"\nimport { CSSVariableToken, isCSSVariableToken } from \"./is-css-variable\"\n\n/**\n * Parse Framer's special CSS variable format into a CSS token and a fallback.\n *\n * ```\n * `var(--foo, #fff)` => [`--foo`, '#fff']\n * ```\n *\n * @param current\n */\n\nconst splitCSSVariableRegex =\n    // eslint-disable-next-line redos-detector/no-unsafe-regex -- false positive, as it can match a lot of words\n    /^var\\(--(?:([\\w-]+)|([\\w-]+), ?([a-zA-Z\\d ()%#.,-]+))\\)/u\nexport function parseCSSVariable(current: string) {\n    const match = splitCSSVariableRegex.exec(current)\n    if (!match) return [,]\n\n    const [, token1, token2, fallback] = match\n    return [`--${token1 ?? token2}`, fallback]\n}\n\nconst maxDepth = 4\nexport function getVariableValue(\n    current: CSSVariableToken,\n    element: Element,\n    depth = 1\n): AnyResolvedKeyframe | undefined {\n    invariant(\n        depth <= maxDepth,\n        `Max CSS variable fallback depth detected in property \"${current}\". This may indicate a circular fallback dependency.`,\n        \"max-css-var-depth\"\n    )\n\n    const [token, fallback] = parseCSSVariable(current)\n\n    // No CSS variable detected\n    if (!token) return\n\n    // Attempt to read this CSS variable off the element\n    const resolved = window.getComputedStyle(element).getPropertyValue(token)\n\n    if (resolved) {\n        const trimmed = resolved.trim()\n        return isNumericalString(trimmed) ? parseFloat(trimmed) : trimmed\n    }\n\n    return isCSSVariableToken(fallback)\n        ? getVariableValue(fallback, element, depth + 1)\n        : fallback\n}\n"]},"metadata":{},"sourceType":"module"}