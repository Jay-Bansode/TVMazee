{"ast":null,"code":"import { MotionValue } from '../../value/index.mjs';\nimport { addAttrValue } from '../attr/index.mjs';\nimport { addStyleValue } from '../style/index.mjs';\nimport { createSelectorEffect } from '../utils/create-dom-effect.mjs';\nimport { createEffect } from '../utils/create-effect.mjs';\nimport { frame } from '../../frameloop/frame.mjs';\n\nfunction addSVGPathValue(element, state, key, value) {\n  frame.render(() => element.setAttribute(\"pathLength\", \"1\"));\n\n  if (key === \"pathOffset\") {\n    return state.set(key, value, () => {\n      // Use unitless value to avoid Safari zoom bug\n      const offset = state.latest[key];\n      element.setAttribute(\"stroke-dashoffset\", `${-offset}`);\n    });\n  } else {\n    if (!state.get(\"stroke-dasharray\")) {\n      state.set(\"stroke-dasharray\", new MotionValue(\"1 1\"), () => {\n        const {\n          pathLength = 1,\n          pathSpacing\n        } = state.latest; // Use unitless values to avoid Safari zoom bug\n\n        element.setAttribute(\"stroke-dasharray\", `${pathLength} ${pathSpacing ?? 1 - Number(pathLength)}`);\n      });\n    }\n\n    return state.set(key, value, undefined, state.get(\"stroke-dasharray\"));\n  }\n}\n\nconst addSVGValue = (element, state, key, value) => {\n  if (key.startsWith(\"path\")) {\n    return addSVGPathValue(element, state, key, value);\n  } else if (key.startsWith(\"attr\")) {\n    return addAttrValue(element, state, convertAttrKey(key), value);\n  }\n\n  const handler = key in element.style ? addStyleValue : addAttrValue;\n  return handler(element, state, key, value);\n};\n\nconst svgEffect = /*@__PURE__*/createSelectorEffect( /*@__PURE__*/createEffect(addSVGValue));\n\nfunction convertAttrKey(key) {\n  return key.replace(/^attr([A-Z])/, (_, firstChar) => firstChar.toLowerCase());\n}\n\nexport { svgEffect };","map":{"version":3,"mappings":";;;;;;;AAQA,SAASA,eAAT,CACIC,OADJ,EAEIC,KAFJ,EAGIC,GAHJ,EAIIC,KAJJ,EAIsB;EAElBC,KAAK,CAACC,MAAN,CAAa,MAAML,OAAO,CAACM,YAAR,CAAqB,YAArB,EAAmC,GAAnC,CAAnB;;EAEA,IAAIJ,GAAG,KAAK,YAAZ,EAA0B;IACtB,OAAOD,KAAK,CAACM,GAAN,CAAUL,GAAV,EAAeC,KAAf,EAAsB,MAAK;;MAE9B,MAAMK,MAAM,GAAGP,KAAK,CAACQ,MAAN,CAAaP,GAAb,CAAf;MACAF,OAAO,CAACM,YAAR,CAAqB,mBAArB,EAA0C,GAAG,CAACE,MAAQ,EAAtD;IACH,CAJM,CAAP;EAKH,CAND,MAMO;IACH,IAAI,CAACP,KAAK,CAACS,GAAN,CAAU,kBAAV,CAAL,EAAoC;MAChCT,KAAK,CAACM,GAAN,CAAU,kBAAV,EAA8B,IAAII,WAAJ,CAAgB,KAAhB,CAA9B,EAAsD,MAAK;QACvD,MAAM;UAAEC,UAAU,GAAG,CAAf;UAAkBC;QAAlB,IAAkCZ,KAAK,CAACQ,MAA9C,CADuD;;QAIvDT,OAAO,CAACM,YAAR,CACI,kBADJ,EAEI,GAAGM,UAAc,eAAW,IAAI,IAAIE,MAAM,CAACF,UAAD,CAAY,EAF1D;MAIH,CARD;IASH;;IAED,OAAOX,KAAK,CAACM,GAAN,CAAUL,GAAV,EAAeC,KAAf,EAAsBY,SAAtB,EAAiCd,KAAK,CAACS,GAAN,CAAU,kBAAV,CAAjC,CAAP;EACH;AACJ;;AAED,MAAMM,WAAW,GAAG,CAChBhB,OADgB,EAEhBC,KAFgB,EAGhBC,GAHgB,EAIhBC,KAJgB,KAKhB;EACA,IAAID,GAAG,CAACe,UAAJ,CAAe,MAAf,CAAJ,EAA4B;IACxB,OAAOlB,eAAe,CAACC,OAAD,EAAUC,KAAV,EAAiBC,GAAjB,EAAsBC,KAAtB,CAAtB;EACH,CAFD,MAEO,IAAID,GAAG,CAACe,UAAJ,CAAe,MAAf,CAAJ,EAA4B;IAC/B,OAAOC,YAAY,CAAClB,OAAD,EAAUC,KAAV,EAAiBkB,cAAc,CAACjB,GAAD,CAA/B,EAAsCC,KAAtC,CAAnB;EACH;;EAED,MAAMiB,OAAO,GAAGlB,GAAG,IAAIF,OAAO,CAACqB,KAAf,GAAuBC,aAAvB,GAAuCJ,YAAvD;EACA,OAAOE,OAAO,CAACpB,OAAD,EAAUC,KAAV,EAAiBC,GAAjB,EAAsBC,KAAtB,CAAd;AACH,CAdD;;AAgBa,eAAS,gBAAiBoB,oBAAoB,EACvD,aAAcC,YAAY,CAACR,WAAD,CAD6B,CAA9C;;AAIb,SAASG,cAAT,CAAwBjB,GAAxB,EAAmC;EAC/B,OAAOA,GAAG,CAACuB,OAAJ,CAAY,cAAZ,EAA4B,CAACC,CAAD,EAAIC,SAAJ,KAC/BA,SAAS,CAACC,WAAV,EADG,CAAP;AAGJ","names":["addSVGPathValue","element","state","key","value","frame","render","setAttribute","set","offset","latest","get","MotionValue","pathLength","pathSpacing","Number","undefined","addSVGValue","startsWith","addAttrValue","convertAttrKey","handler","style","addStyleValue","createSelectorEffect","createEffect","replace","_","firstChar","toLowerCase"],"sources":["C:\\Projects\\TVMazee\\node_modules\\motion-dom\\src\\effects\\svg\\index.ts"],"sourcesContent":["import { frame } from \"../../frameloop\"\nimport { MotionValue } from \"../../value\"\nimport { addAttrValue } from \"../attr\"\nimport { MotionValueState } from \"../MotionValueState\"\nimport { addStyleValue } from \"../style\"\nimport { createSelectorEffect } from \"../utils/create-dom-effect\"\nimport { createEffect } from \"../utils/create-effect\"\n\nfunction addSVGPathValue(\n    element: SVGElement,\n    state: MotionValueState,\n    key: string,\n    value: MotionValue\n) {\n    frame.render(() => element.setAttribute(\"pathLength\", \"1\"))\n\n    if (key === \"pathOffset\") {\n        return state.set(key, value, () => {\n            // Use unitless value to avoid Safari zoom bug\n            const offset = state.latest[key]\n            element.setAttribute(\"stroke-dashoffset\", `${-offset}`)\n        })\n    } else {\n        if (!state.get(\"stroke-dasharray\")) {\n            state.set(\"stroke-dasharray\", new MotionValue(\"1 1\"), () => {\n                const { pathLength = 1, pathSpacing } = state.latest\n\n                // Use unitless values to avoid Safari zoom bug\n                element.setAttribute(\n                    \"stroke-dasharray\",\n                    `${pathLength} ${pathSpacing ?? 1 - Number(pathLength)}`\n                )\n            })\n        }\n\n        return state.set(key, value, undefined, state.get(\"stroke-dasharray\"))\n    }\n}\n\nconst addSVGValue = (\n    element: SVGElement,\n    state: MotionValueState,\n    key: string,\n    value: MotionValue\n) => {\n    if (key.startsWith(\"path\")) {\n        return addSVGPathValue(element, state, key, value)\n    } else if (key.startsWith(\"attr\")) {\n        return addAttrValue(element, state, convertAttrKey(key), value)\n    }\n\n    const handler = key in element.style ? addStyleValue : addAttrValue\n    return handler(element, state, key, value)\n}\n\nexport const svgEffect = /*@__PURE__*/ createSelectorEffect(\n    /*@__PURE__*/ createEffect(addSVGValue)\n)\n\nfunction convertAttrKey(key: string) {\n    return key.replace(/^attr([A-Z])/, (_, firstChar) =>\n        firstChar.toLowerCase()\n    )\n}\n"]},"metadata":{},"sourceType":"module"}