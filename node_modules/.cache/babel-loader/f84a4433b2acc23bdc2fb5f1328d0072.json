{"ast":null,"code":"class GroupAnimation {\n  constructor(animations) {\n    // Bound to accomadate common `return animation.stop` pattern\n    this.stop = () => this.runAll(\"stop\");\n\n    this.animations = animations.filter(Boolean);\n  }\n\n  get finished() {\n    return Promise.all(this.animations.map(animation => animation.finished));\n  }\n  /**\n   * TODO: Filter out cancelled or stopped animations before returning\n   */\n\n\n  getAll(propName) {\n    return this.animations[0][propName];\n  }\n\n  setAll(propName, newValue) {\n    for (let i = 0; i < this.animations.length; i++) {\n      this.animations[i][propName] = newValue;\n    }\n  }\n\n  attachTimeline(timeline) {\n    const subscriptions = this.animations.map(animation => animation.attachTimeline(timeline));\n    return () => {\n      subscriptions.forEach((cancel, i) => {\n        cancel && cancel();\n        this.animations[i].stop();\n      });\n    };\n  }\n\n  get time() {\n    return this.getAll(\"time\");\n  }\n\n  set time(time) {\n    this.setAll(\"time\", time);\n  }\n\n  get speed() {\n    return this.getAll(\"speed\");\n  }\n\n  set speed(speed) {\n    this.setAll(\"speed\", speed);\n  }\n\n  get state() {\n    return this.getAll(\"state\");\n  }\n\n  get startTime() {\n    return this.getAll(\"startTime\");\n  }\n\n  get duration() {\n    return getMax(this.animations, \"duration\");\n  }\n\n  get iterationDuration() {\n    return getMax(this.animations, \"iterationDuration\");\n  }\n\n  runAll(methodName) {\n    this.animations.forEach(controls => controls[methodName]());\n  }\n\n  play() {\n    this.runAll(\"play\");\n  }\n\n  pause() {\n    this.runAll(\"pause\");\n  }\n\n  cancel() {\n    this.runAll(\"cancel\");\n  }\n\n  complete() {\n    this.runAll(\"complete\");\n  }\n\n}\n\nfunction getMax(animations, propName) {\n  let max = 0;\n\n  for (let i = 0; i < animations.length; i++) {\n    const value = animations[i][propName];\n\n    if (value !== null && value > max) {\n      max = value;\n    }\n  }\n\n  return max;\n}\n\nexport { GroupAnimation };","map":{"version":3,"mappings":"MAcaA,eAAc;EAGvBC,YAAYC,UAAZ,EAA6D;;IAsF7D,KAAIC,IAAJ,GAAO,MAAM,KAAKC,MAAL,CAAY,MAAZ,CAAb;;IArFI,KAAKF,UAAL,GAAkBA,UAAU,CAACG,MAAX,CAAkBC,OAAlB,CAAlB;EACH;;EAEW,IAARC,QAAQ;IACR,OAAOC,OAAO,CAACC,GAAR,CACH,KAAKP,UAAL,CAAgBQ,GAAhB,CAAqBC,SAAD,IAAeA,SAAS,CAACJ,QAA7C,CADG,CAAP;EAGH;EAED;;AAEG;;;EACKK,MAAM,CAACC,QAAD,EAAoB;IAC9B,OAAO,KAAKX,UAAL,CAAgB,CAAhB,EAAmBW,QAAnB,CAAP;EACH;;EAEOC,MAAM,CAACD,QAAD,EAAsBE,QAAtB,EAAmC;IAC7C,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKd,UAAL,CAAgBe,MAApC,EAA4CD,CAAC,EAA7C,EAAiD;MAC3C,KAAKd,UAAL,CAAgBc,CAAhB,EAAmBH,QAAnB,IAAuCE,QAAvC;IACL;EACJ;;EAEDG,cAAc,CAACC,QAAD,EAA+B;IACzC,MAAMC,aAAa,GAAG,KAAKlB,UAAL,CAAgBQ,GAAhB,CAAqBC,SAAD,IACtCA,SAAS,CAACO,cAAV,CAAyBC,QAAzB,CADkB,CAAtB;IAIA,OAAO,MAAK;MACRC,aAAa,CAACC,OAAd,CAAsB,CAACC,MAAD,EAASN,CAAT,KAAc;QAChCM,MAAM,IAAIA,MAAM,EAAhB;QACA,KAAKpB,UAAL,CAAgBc,CAAhB,EAAmBb,IAAnB;MACH,CAHD;IAIH,CALD;EAMH;;EAEO,IAAJoB,IAAI;IACJ,OAAO,KAAKX,MAAL,CAAY,MAAZ,CAAP;EACH;;EAEO,IAAJW,IAAI,CAACA,IAAD,EAAa;IACjB,KAAKT,MAAL,CAAY,MAAZ,EAAoBS,IAApB;EACH;;EAEQ,IAALC,KAAK;IACL,OAAO,KAAKZ,MAAL,CAAY,OAAZ,CAAP;EACH;;EAEQ,IAALY,KAAK,CAACA,KAAD,EAAc;IACnB,KAAKV,MAAL,CAAY,OAAZ,EAAqBU,KAArB;EACH;;EAEQ,IAALC,KAAK;IACL,OAAO,KAAKb,MAAL,CAAY,OAAZ,CAAP;EACH;;EAEY,IAATc,SAAS;IACT,OAAO,KAAKd,MAAL,CAAY,WAAZ,CAAP;EACH;;EAEW,IAARe,QAAQ;IACR,OAAOC,MAAM,CAAC,KAAK1B,UAAN,EAAkB,UAAlB,CAAb;EACH;;EAEoB,IAAjB2B,iBAAiB;IACjB,OAAOD,MAAM,CAAC,KAAK1B,UAAN,EAAkB,mBAAlB,CAAb;EACH;;EAEOE,MAAM,CACV0B,UADU,EAIT;IAED,KAAK5B,UAAL,CAAgBmB,OAAhB,CAAyBU,QAAD,IAAcA,QAAQ,CAACD,UAAD,CAAR,EAAtC;EACH;;EAEDE,IAAI;IACA,KAAK5B,MAAL,CAAY,MAAZ;EACH;;EAED6B,KAAK;IACD,KAAK7B,MAAL,CAAY,OAAZ;EACH;;EAKDkB,MAAM;IACF,KAAKlB,MAAL,CAAY,QAAZ;EACH;;EAED8B,QAAQ;IACJ,KAAK9B,MAAL,CAAY,UAAZ;EACH;;AAjGsB;;AAoG3B,SAASwB,MAAT,CACI1B,UADJ,EAEIW,QAFJ,EAE8C;EAE1C,IAAIsB,GAAG,GAAG,CAAV;;EAEA,KAAK,IAAInB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,UAAU,CAACe,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;IACxC,MAAMoB,KAAK,GAAGlC,UAAU,CAACc,CAAD,CAAV,CAAcH,QAAd,CAAd;;IACA,IAAIuB,KAAK,KAAK,IAAV,IAAkBA,KAAK,GAAGD,GAA9B,EAAmC;MAC/BA,GAAG,GAAGC,KAAN;IACH;EACJ;;EACD,OAAOD,GAAP;AACJ","names":["GroupAnimation","constructor","animations","stop","runAll","filter","Boolean","finished","Promise","all","map","animation","getAll","propName","setAll","newValue","i","length","attachTimeline","timeline","subscriptions","forEach","cancel","time","speed","state","startTime","duration","getMax","iterationDuration","methodName","controls","play","pause","complete","max","value"],"sources":["C:\\Projects\\TVMazee\\node_modules\\motion-dom\\src\\animation\\GroupAnimation.ts"],"sourcesContent":["import { AnimationPlaybackControls, TimelineWithFallback } from \"./types\"\n\ntype PropNames =\n    | \"time\"\n    | \"speed\"\n    | \"duration\"\n    | \"attachTimeline\"\n    | \"startTime\"\n    | \"state\"\n\nexport type AcceptedAnimations = AnimationPlaybackControls\n\nexport type GroupedAnimations = AcceptedAnimations[]\n\nexport class GroupAnimation implements AnimationPlaybackControls {\n    animations: GroupedAnimations\n\n    constructor(animations: Array<AcceptedAnimations | undefined>) {\n        this.animations = animations.filter(Boolean) as GroupedAnimations\n    }\n\n    get finished() {\n        return Promise.all(\n            this.animations.map((animation) => animation.finished)\n        )\n    }\n\n    /**\n     * TODO: Filter out cancelled or stopped animations before returning\n     */\n    private getAll(propName: PropNames) {\n        return this.animations[0][propName] as any\n    }\n\n    private setAll(propName: PropNames, newValue: any) {\n        for (let i = 0; i < this.animations.length; i++) {\n            ;(this.animations[i][propName] as any) = newValue\n        }\n    }\n\n    attachTimeline(timeline: TimelineWithFallback) {\n        const subscriptions = this.animations.map((animation) =>\n            animation.attachTimeline(timeline)\n        )\n\n        return () => {\n            subscriptions.forEach((cancel, i) => {\n                cancel && cancel()\n                this.animations[i].stop()\n            })\n        }\n    }\n\n    get time() {\n        return this.getAll(\"time\")\n    }\n\n    set time(time: number) {\n        this.setAll(\"time\", time)\n    }\n\n    get speed() {\n        return this.getAll(\"speed\")\n    }\n\n    set speed(speed: number) {\n        this.setAll(\"speed\", speed)\n    }\n\n    get state() {\n        return this.getAll(\"state\")\n    }\n\n    get startTime() {\n        return this.getAll(\"startTime\")\n    }\n\n    get duration() {\n        return getMax(this.animations, \"duration\")\n    }\n\n    get iterationDuration() {\n        return getMax(this.animations, \"iterationDuration\")\n    }\n\n    private runAll(\n        methodName: keyof Omit<\n            AnimationPlaybackControls,\n            PropNames | \"then\" | \"finished\" | \"iterationDuration\"\n        >\n    ) {\n        this.animations.forEach((controls) => controls[methodName]())\n    }\n\n    play() {\n        this.runAll(\"play\")\n    }\n\n    pause() {\n        this.runAll(\"pause\")\n    }\n\n    // Bound to accomadate common `return animation.stop` pattern\n    stop = () => this.runAll(\"stop\")\n\n    cancel() {\n        this.runAll(\"cancel\")\n    }\n\n    complete() {\n        this.runAll(\"complete\")\n    }\n}\n\nfunction getMax(\n    animations: GroupedAnimations,\n    propName: \"iterationDuration\" | \"duration\"\n): number {\n    let max = 0\n\n    for (let i = 0; i < animations.length; i++) {\n        const value = animations[i][propName]\n        if (value !== null && value > max) {\n            max = value\n        }\n    }\n    return max\n}\n"]},"metadata":{},"sourceType":"module"}